//end_exam_eligibility


CREATE VIEW end_exam_eligibility AS
SELECT 
    attendance_eligibility.stu_id AS Student,
    attendance_eligibility.course_code AS Course,
    CASE
        WHEN attendance_eligibility.Eligibility = 'Eligible' AND CA_marks_eligible.CA_eligibility = 'eligible' THEN 'Eligible'
        ELSE 'Not Eligible'
    END AS End_Exam_Eligibility
FROM attendance_eligibility,CA_marks_eligible 
WHERE attendance_eligibility.stu_id = CA_marks_eligible.stu_id AND attendance_eligibility.course_code = CA_marks_eligible.course_code AND attendance_eligibility.Type != 'E_T' AND attendance_eligibility.Type != 'E_TP' AND attendance_eligibility.Type != 'E_P';



///getting final results(ca+end)....


 CREATE VIEW combined_results AS
 SELECT
     e.Student,
     e.Course,

     CASE
		WHEN e.Course = 'ENG1222' THEN fr.English_Final_Mark
		WHEN e.Course = 'ICT1212' THEN fr.DBMS_theory_Final_Mark
		WHEN e.Course = 'ICT1222' THEN fr.DBMS_practical_Final_Mark
		WHEN e.Course = 'ICT1233' THEN fr.Server_side_Final_Mark
		WHEN e.Course = 'ICT1242' THEN fr.Computer_architecture_Final_Mark
		WHEN e.Course = 'ICT1253' THEN fr.Computer_Network_Final_Mark
		WHEN e.Course = 'TCS1212' THEN fr.Management_Final_Mark
		WHEN e.Course = 'TCS1233' THEN fr.D_maths_Final_Mark
     ELSE 0
		END AS Final_Mark
    FROM
		Eligible e
    JOIN
      final_results fr ON  e.Course = fr.Course_code;
